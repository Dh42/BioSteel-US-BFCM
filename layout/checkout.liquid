<!DOCTYPE html>
<html lang="{{ locale }}" dir="{{ direction }}" class="{{ checkout_html_classes }}">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, height=device-height, minimum-scale=1.0, user-scalable=0">
    <meta name="referrer" content="origin">

    <title>{{ page_title }}</title>
    
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    
   
    {{ 'magnific.scss.css' | asset_url | stylesheet_tag }}
    {{ 'magnific.js' | asset_url | script_tag }}

    {% include 'GTM-head' %}

    {{ content_for_header }}

    {{ checkout_stylesheets }}
    {{ checkout_scripts }}
    <link type="text/css" href="{{ '213a.scss.css' | asset_url }}" rel="stylesheet">
    
    <style type="text/css">
      #error-for-reduction_code{
        visibility:hidden;
        height: 0px;
      }
    </style>
    
    <script type="text/javascript">
      function setCookie(cname,cvalue,exdays){
        var d = new Date();
        d.setTime(d.getTime() + (exdays*24*60*60*1000));
        var expires = "expires="+ d.toUTCString();
        document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
      }

      function getCookie(cname){
        var name = cname + "=";
        var decodedCookie = decodeURIComponent(document.cookie);
        var ca = decodedCookie.split(';');
        for(var i = 0; i <ca.length; i++){
          var c = ca[i];
          while (c.charAt(0) == ' '){
            c = c.substring(1);
          }
          if(c.indexOf(name) == 0){
            return c.substring(name.length, c.length);
          }
        }
        return "";
      }

      function deleteCookie(name){
        document.cookie = name +'=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;';
      }
    </script>

  </head>
  <body>
    
    <div id="welcome_box_popup" class="white-popup mfp-hide" style="text-align:center;">
      <h1 class="head" style="color: #000;text-align:center;">You're Almost There!</h1>
      <p style="color:red;">Free Welcome Box requires the purchase of another full price item</p>
      <ol style="display: inline-block;text-align: left;margin-top:10px;">
        <li>Add any product to your cart</li>
        <li>Come back to checkout</li>
        <li>Your Welcome Box will be FREE!</li>
      </ol>
      <p style="text-align:center;margin-top:15px;">
        <a style="padding:0.4em 0.7em;" href="/collections/all-products" class="ProductTile__button Button Button--primary btn btn--secondary cart__update cart__continue--small">KEEP SHOPPING</a>
      </p>
      <!--
      Minimum one item must be purchased to receive the free welcome box. Add another product to your cart and apply your coupon to redeem your free gift. <a href='/collections/all-products'>Click Here To Keep Shopping</a>.
      -->
    </div>
    
    {{ skip_to_content_link }}

    {% include 'GTM-body' %}

    <div class="banner" data-header>
      <div class="wrap">
        {{ content_for_logo }}
      </div>
    </div>

    {{ order_summary_toggle }}

    <div class="content" data-content>
      <div class="wrap">
        <div class="main" role="main">
          <div class="main__header">
            {{ content_for_logo }}
            {{ breadcrumb }}
            {{ alternative_payment_methods }}
          </div>
          <div class="main__content">
            {{ content_for_layout }}
          </div>
          <div class="main__footer">
            {{ content_for_footer }}
          </div>
        </div>
        <div class="sidebar" role="complementary">
          <div class="sidebar__header">
            {{ content_for_logo }}
          </div>
          <div class="sidebar__content">
            {{ content_for_order_summary }}
          </div>
        </div>
      </div>
    </div>

    {{ tracking_code }}
    <script>
    (function() {
      var defaultTexts = {
        'Expedited Parcel': '4 to 10 business days',
        'Canada Post Xpresspost': '3 to 5 business days',
        'Canada Post Priority': '2 to 4 business days',
        'default': ''
      }
      var config = {
        'Expedited Parcel': 0,//3,
        'Canada Post Xpresspost': 0,// 2,
        'Canada Post Priority': 0, //1,
        'default': 0
      }
       setInterval(function() {
         var shippingSection = document.querySelector('.section--shipping-method')
         if (!shippingSection) {
           return
         }
         var labels = shippingSection.querySelectorAll('.radio__label__primary')
         for(var i=0; i<labels.length; ++i) {
           var label = labels[i].querySelector('span.small-text')
           var valueText = labels[i].attributes && labels[i].attributes['data-shipping-method-label-title'] ? labels[i].attributes['data-shipping-method-label-title'].value : 'default'
           var value = config && config[valueText] ? config[valueText] : config['default']
           if (!label) {
             label = document.createElement('SPAN')
             label.classList.add('small-text')
             label.textContent = defaultTexts && defaultTexts[valueText] || ''
             labels[i].appendChild(label)
           }
           if (!label || label.classList.contains('hijacked')) {
             continue
           }
           var text = (defaultTexts && defaultTexts[valueText] || label.textContent).split(' ')
           var newText = []
           for(var j = 0; j < text.length; ++j) {
             var word = text[j]
             if (!isNaN(word)) {
               word = (word * 1) + value
             }
             newText.push(word)
           }
           label.textContent = newText.join(' ')
           label.classList.add('hijacked')
         }

      }, 700)
    })()
    </script>
    
    <script type="text/javascript">
      
      
      
      
      function saveFieldValues(){
        if($("#checkout_shipping_address_first_name").length > 0){
          var email = $("input[name='checkout[email]']").val();
          var fname = $("#checkout_shipping_address_first_name").val();
          var lname = $("#checkout_shipping_address_last_name").val();
          var address1 = $("#checkout_shipping_address_address1").val();
          var address2prefix = $("#address2prefix").val();
          var address2 = $("#checkout_shipping_address_address2").val();
          var city = $("#checkout_shipping_address_city").val();
          var country = $("#checkout_shipping_address_country").val();
          var state = $("#checkout_shipping_address_province").val();
          var zip = $("#checkout_shipping_address_zip").val();
          var phone = $("#checkout_shipping_address_phone").val();
          var company = $("#checkout_shipping_address_company").val();
            
          setCookie("email",email);
          setCookie("fname",fname);
          setCookie("lname",lname);
          setCookie("address1",address1);
          setCookie("address2prefix",address2prefix);
          setCookie("address2",address2);
          setCookie("city",city);
          setCookie("country",country);
          setCookie("state",state);
          setCookie("zip",zip);
          setCookie("phone",phone);
          if(company){setCookie("company",company);}
        }
      }
      
      function setFieldValues(){
        if($("#checkout_shipping_address_first_name").length > 0){
          var email = getCookie("email");
          if(email && email.length > 0){
            $("input[name='checkout[email]']").val(email);
          }
          //deleteCookie("email");
          
          var fname = getCookie("fname");
          if(fname && fname.length > 0){
            $("#checkout_shipping_address_first_name").val(fname);
          }
          //deleteCookie("fname");
          
          var lname = getCookie("lname");
          if(lname && lname.length > 0){
            $("#checkout_shipping_address_last_name").val(lname);
          }
          //deleteCookie("lname");
          
          var company = getCookie("company");
          if(company && company.length > 0){
            $("#checkout_shipping_address_company").val(company);
          }
          //deleteCookie("company");
          
          
          var address1 = getCookie("address1");
          if(address1 && address1.length > 0){
            $("#checkout_shipping_address_address1").val(address1);
          }
          //deleteCookie("address1");
          
          var address2prefix = getCookie("address2prefix");
          if(address2prefix && address2prefix.length > 0){
            $("#address2prefix").val(address2prefix);
          }
          //deleteCookie("address2prefix");
          
          var address2 = getCookie("address2");
          if(address2 && address2.length > 0){
            $("#checkout_shipping_address_address2").val(address2);
          }
          //deleteCookie("address2");
          
          var city = getCookie("city");
          if(city && city.length > 0){
            $("#checkout_shipping_address_city").val(city);
          }
          //deleteCookie("city");
          
          var country = getCookie("country");
          if(country && country.length > 0){
            $("#checkout_shipping_address_country").val(country);
          }
          //deleteCookie("country");
          
          var state = getCookie("state");
          if(state && state.length > 0){
            $("#checkout_shipping_address_province").val(state);
          }
          //deleteCookie("state");
          
          var zip = getCookie("zip");
          if(zip && zip.length > 0){
            $("#checkout_shipping_address_zip").val(zip);
          }
          //deleteCookie("zip");
          
          var phone = getCookie("phone");
          if(phone && phone.length > 0){
            $("#checkout_shipping_address_phone").val(phone);
          }
          //deleteCookie("phone");
        }
      }
      
      if($("#checkout_shipping_address_first_name").length > 0){
        setTimeout(setFieldValues,200);
        setTimeout(setFieldValues,1000);
      }
      
      
      
      
      //check cookie coupon
      function applyRedCode(reduction_code){
        $("#checkout_reduction_code").val(reduction_code);
        $("#checkout_reduction_code").parent().parent().find(".field__input-btn").removeAttr("disabled");
        $("#checkout_reduction_code").parent().parent().find(".field__input-btn").click();
        setTimeout(function(){
          {% comment %}
          deleteCookie("reduction_code");
          {% for item in checkout.line_items %}
{%- comment -%} Wholesale_Club_Product_Visibility_For_Loop Start {%- endcomment -%}
{%- capture hide_resource -%}{% render "wc_product_visibility", resource: item %}{%- endcapture -%}
{%- if hide_resource == "true" -%}
  {% continue %}
{%- endif -%}
{%- comment -%} Wholesale_Club_Product_Visibility_For_Loop End {%- endcomment -%}

{% comment %} Wholesale_Club_Item_Prices Start {% endcomment %}
{% if item.product %}{% assign base_product = item.product %}{% else %}{% assign base_product = item %}{% endif %}
{% if item.variant %}{% assign base_variant = item.variant %}{% else %}{% assign base_variant = item.selected_or_first_available_variant %}{% endif %}

{% if shop.metafields.sawholesale['base_price'] == blank %}
  {% assign base_price = 'compare_at_price' %}
{% else %}
  {% assign base_price = shop.metafields.sawholesale['base_price'] %}
{% endif %}

{% assign saw_discount = 0 %}{% assign saw_has_discount = false %}

{% if customer.tags != blank %}
  {% for mf in base_product.metafields.sawholesale %}
{%- comment -%} Wholesale_Club_Product_Visibility_For_Loop Start {%- endcomment -%}
{%- capture hide_resource -%}{% render "wc_product_visibility", resource: mf %}{%- endcapture -%}
{%- if hide_resource == "true" -%}
  {% continue %}
{%- endif -%}
{%- comment -%} Wholesale_Club_Product_Visibility_For_Loop End {%- endcomment -%}

    {% capture product_customer_tag %}{{ mf | first | replace: 'discount_', '' }}{% endcapture %}
    {% if customer.tags contains product_customer_tag %}
      {% assign saw_has_discount = true %}
      {% assign discount_key = product_customer_tag | prepend: 'discount_' %}
      {% assign price_key = product_customer_tag | prepend: 'price_' %}
      {% assign saw_discount = base_product.metafields.sawholesale[discount_key] | divided_by: 100.0 %}
    {% endif %}
  {% endfor %}
{% endif %}

{% assign saw_discount = 1 | minus: saw_discount %}

{% if base_price == 'price' or base_variant.compare_at_price == blank  or base_variant.compare_at_price == 0 or base_variant.compare_at_price < base_variant.price %}
  {% assign saw_variant_compare_at_price = base_variant.price %}
{% else %}
  {% assign saw_variant_compare_at_price = base_variant.compare_at_price %}
{% endif %}

{% assign cpe = shop.metafields.sawholesale['cpe'] | default: "true" %}
{% if base_variant.metafields.sawholesale[price_key] != blank and cpe == "true" %}
  {% assign saw_variant_price = base_variant.metafields.sawholesale[price_key] %}
{% else %}
  {% assign saw_variant_price = saw_variant_compare_at_price | times: saw_discount %}
{% endif %}

{% if saw_has_discount == false or saw_variant_price >= saw_variant_compare_at_price %}
  {% assign WCItem_OriginalPrice = item.original_price %}
  {% assign WCItem_FinalPrice = item.final_price %}
  {% assign WCItem_Price = item.price %}
  {% assign WCItem_PriceMin = item.price_min %}
  {% assign WCItem_PriceMax = item.price_max %}
  {% assign WCItem_CompareAtPrice = item.compare_at_price %}
  {% assign WCItem_CompareAtPriceMin = item.compare_at_price_min %}
  {% assign WCItem_CompareAtPriceMax = item.compare_at_price_max %}
  {% assign WCItem_OriginalLinePrice = item.original_line_price %}
  {% assign WCItem_FinalLinePrice = item.final_line_price %}
  {% assign WCItem_LinePrice = item.line_price %}
{% else %}
  {% assign WCItem_OriginalPrice = saw_variant_compare_at_price %}
  {% assign WCItem_FinalPrice = saw_variant_price %}
  {% assign WCItem_Price = saw_variant_price %}
  {% assign WCItem_PriceMin = item.price_min | times: saw_discount %}
  {% assign WCItem_PriceMax = item.price_max | times: saw_discount %}
  {% assign WCItem_CompareAtPrice = saw_variant_compare_at_price %}
  {% if base_product.compare_at_price_min != 0 %}{% assign WCItem_CompareAtPriceMin = base_product.compare_at_price_min %}{% else %}{% assign WCItem_CompareAtPriceMin = base_product.price_min %}{% endif %}
  {% if base_product.compare_at_price_max != 0 %}{% assign WCItem_CompareAtPriceMax = base_product.compare_at_price_max %}{% else %}{% assign WCItem_CompareAtPriceMax = base_product.price_max %}{% endif %}
  {% assign WCItem_OriginalLinePrice = WCItem_OriginalPrice | round | times: item.quantity %}
  {% assign WCItem_FinalLinePrice = WCItem_FinalPrice | round | times: item.quantity %}
  {% assign WCItem_LinePrice = WCItem_Price | round | times: item.quantity %}
{% endif %}
{% comment %} Wholesale_Club_Item_Prices End {% endcomment %}

          var varid = '{{item.variant.id}}';
          var hasc = getCookie("dis_"+varid);
          if(hasc == "1"){
            deleteCookie("dis_"+varid);
          }
          {% endfor %}
          {% endcomment %}
          saveFieldValues();
          
          window.location.reload();
        },6000);
      }

      var from_cart = getCookie("from_cart");
      var reduction_code = getCookie("reduction_code");
      console.log(reduction_code);
      if(from_cart == "1" && reduction_code !== null && reduction_code !== "" && reduction_code){
        {% for item in checkout.line_items %}
{%- comment -%} Wholesale_Club_Product_Visibility_For_Loop Start {%- endcomment -%}
{%- capture hide_resource -%}{% render "wc_product_visibility", resource: item %}{%- endcapture -%}
{%- if hide_resource == "true" -%}
  {% continue %}
{%- endif -%}
{%- comment -%} Wholesale_Club_Product_Visibility_For_Loop End {%- endcomment -%}

{% comment %} Wholesale_Club_Item_Prices Start {% endcomment %}
{% if item.product %}{% assign base_product = item.product %}{% else %}{% assign base_product = item %}{% endif %}
{% if item.variant %}{% assign base_variant = item.variant %}{% else %}{% assign base_variant = item.selected_or_first_available_variant %}{% endif %}

{% if shop.metafields.sawholesale['base_price'] == blank %}
  {% assign base_price = 'compare_at_price' %}
{% else %}
  {% assign base_price = shop.metafields.sawholesale['base_price'] %}
{% endif %}

{% assign saw_discount = 0 %}{% assign saw_has_discount = false %}

{% if customer.tags != blank %}
  {% for mf in base_product.metafields.sawholesale %}
{%- comment -%} Wholesale_Club_Product_Visibility_For_Loop Start {%- endcomment -%}
{%- capture hide_resource -%}{% render "wc_product_visibility", resource: mf %}{%- endcapture -%}
{%- if hide_resource == "true" -%}
  {% continue %}
{%- endif -%}
{%- comment -%} Wholesale_Club_Product_Visibility_For_Loop End {%- endcomment -%}

    {% capture product_customer_tag %}{{ mf | first | replace: 'discount_', '' }}{% endcapture %}
    {% if customer.tags contains product_customer_tag %}
      {% assign saw_has_discount = true %}
      {% assign discount_key = product_customer_tag | prepend: 'discount_' %}
      {% assign price_key = product_customer_tag | prepend: 'price_' %}
      {% assign saw_discount = base_product.metafields.sawholesale[discount_key] | divided_by: 100.0 %}
    {% endif %}
  {% endfor %}
{% endif %}

{% assign saw_discount = 1 | minus: saw_discount %}

{% if base_price == 'price' or base_variant.compare_at_price == blank  or base_variant.compare_at_price == 0 or base_variant.compare_at_price < base_variant.price %}
  {% assign saw_variant_compare_at_price = base_variant.price %}
{% else %}
  {% assign saw_variant_compare_at_price = base_variant.compare_at_price %}
{% endif %}

{% assign cpe = shop.metafields.sawholesale['cpe'] | default: "true" %}
{% if base_variant.metafields.sawholesale[price_key] != blank and cpe == "true" %}
  {% assign saw_variant_price = base_variant.metafields.sawholesale[price_key] %}
{% else %}
  {% assign saw_variant_price = saw_variant_compare_at_price | times: saw_discount %}
{% endif %}

{% if saw_has_discount == false or saw_variant_price >= saw_variant_compare_at_price %}
  {% assign WCItem_OriginalPrice = item.original_price %}
  {% assign WCItem_FinalPrice = item.final_price %}
  {% assign WCItem_Price = item.price %}
  {% assign WCItem_PriceMin = item.price_min %}
  {% assign WCItem_PriceMax = item.price_max %}
  {% assign WCItem_CompareAtPrice = item.compare_at_price %}
  {% assign WCItem_CompareAtPriceMin = item.compare_at_price_min %}
  {% assign WCItem_CompareAtPriceMax = item.compare_at_price_max %}
  {% assign WCItem_OriginalLinePrice = item.original_line_price %}
  {% assign WCItem_FinalLinePrice = item.final_line_price %}
  {% assign WCItem_LinePrice = item.line_price %}
{% else %}
  {% assign WCItem_OriginalPrice = saw_variant_compare_at_price %}
  {% assign WCItem_FinalPrice = saw_variant_price %}
  {% assign WCItem_Price = saw_variant_price %}
  {% assign WCItem_PriceMin = item.price_min | times: saw_discount %}
  {% assign WCItem_PriceMax = item.price_max | times: saw_discount %}
  {% assign WCItem_CompareAtPrice = saw_variant_compare_at_price %}
  {% if base_product.compare_at_price_min != 0 %}{% assign WCItem_CompareAtPriceMin = base_product.compare_at_price_min %}{% else %}{% assign WCItem_CompareAtPriceMin = base_product.price_min %}{% endif %}
  {% if base_product.compare_at_price_max != 0 %}{% assign WCItem_CompareAtPriceMax = base_product.compare_at_price_max %}{% else %}{% assign WCItem_CompareAtPriceMax = base_product.price_max %}{% endif %}
  {% assign WCItem_OriginalLinePrice = WCItem_OriginalPrice | round | times: item.quantity %}
  {% assign WCItem_FinalLinePrice = WCItem_FinalPrice | round | times: item.quantity %}
  {% assign WCItem_LinePrice = WCItem_Price | round | times: item.quantity %}
{% endif %}
{% comment %} Wholesale_Club_Item_Prices End {% endcomment %}

        var varid = '{{item.variant.id}}';
        var hasc = getCookie("dis_"+varid);
        if(hasc == "1"){
          applyRedCode(reduction_code);
        }
        {% endfor %}    
        deleteCookie("from_cart");
      }
      
    </script>
    
    {% include 'new-email-domain-discount' %}
    
    {% include 'email-domain-discount' %}
    
    {% include 'free-product-coupon-checkout' %}
    
    {% if settings.free_bottle_script_enabled == true %}
    {% include 'free-bottle-above-price' %}
    {% endif %}
    
    {% if settings.free_hydration_mix_script_enabled == true %}
    {% include 'free-hydration-mix' %}
    {% endif %}
    
    {% assign promo_coupon_applied = false %}
    {% for discount in checkout.discount_applications %}
{%- comment -%} Wholesale_Club_Product_Visibility_For_Loop Start {%- endcomment -%}
{%- capture hide_resource -%}{% render "wc_product_visibility", resource: discount %}{%- endcapture -%}
{%- if hide_resource == "true" -%}
  {% continue %}
{%- endif -%}
{%- comment -%} Wholesale_Club_Product_Visibility_For_Loop End {%- endcomment -%}

    
      {% assign code_size = discount.title | size %}
      {% assign cletter = discount.title | slice: 0, 3 %}
      {% if cletter == "USA" and code_size == 7 %}
        {% assign promo_coupon_applied = true %}
        {% break %}
      {% endif %}
    {% endfor %}

   {% for item in checkout.line_items %}
{%- comment -%} Wholesale_Club_Product_Visibility_For_Loop Start {%- endcomment -%}
{%- capture hide_resource -%}{% render "wc_product_visibility", resource: item %}{%- endcapture -%}
{%- if hide_resource == "true" -%}
  {% continue %}
{%- endif -%}
{%- comment -%} Wholesale_Club_Product_Visibility_For_Loop End {%- endcomment -%}

{% comment %} Wholesale_Club_Item_Prices Start {% endcomment %}
{% if item.product %}{% assign base_product = item.product %}{% else %}{% assign base_product = item %}{% endif %}
{% if item.variant %}{% assign base_variant = item.variant %}{% else %}{% assign base_variant = item.selected_or_first_available_variant %}{% endif %}

{% if shop.metafields.sawholesale['base_price'] == blank %}
  {% assign base_price = 'compare_at_price' %}
{% else %}
  {% assign base_price = shop.metafields.sawholesale['base_price'] %}
{% endif %}

{% assign saw_discount = 0 %}{% assign saw_has_discount = false %}

{% if customer.tags != blank %}
  {% for mf in base_product.metafields.sawholesale %}
{%- comment -%} Wholesale_Club_Product_Visibility_For_Loop Start {%- endcomment -%}
{%- capture hide_resource -%}{% render "wc_product_visibility", resource: mf %}{%- endcapture -%}
{%- if hide_resource == "true" -%}
  {% continue %}
{%- endif -%}
{%- comment -%} Wholesale_Club_Product_Visibility_For_Loop End {%- endcomment -%}

    {% capture product_customer_tag %}{{ mf | first | replace: 'discount_', '' }}{% endcapture %}
    {% if customer.tags contains product_customer_tag %}
      {% assign saw_has_discount = true %}
      {% assign discount_key = product_customer_tag | prepend: 'discount_' %}
      {% assign price_key = product_customer_tag | prepend: 'price_' %}
      {% assign saw_discount = base_product.metafields.sawholesale[discount_key] | divided_by: 100.0 %}
    {% endif %}
  {% endfor %}
{% endif %}

{% assign saw_discount = 1 | minus: saw_discount %}

{% if base_price == 'price' or base_variant.compare_at_price == blank  or base_variant.compare_at_price == 0 or base_variant.compare_at_price < base_variant.price %}
  {% assign saw_variant_compare_at_price = base_variant.price %}
{% else %}
  {% assign saw_variant_compare_at_price = base_variant.compare_at_price %}
{% endif %}

{% assign cpe = shop.metafields.sawholesale['cpe'] | default: "true" %}
{% if base_variant.metafields.sawholesale[price_key] != blank and cpe == "true" %}
  {% assign saw_variant_price = base_variant.metafields.sawholesale[price_key] %}
{% else %}
  {% assign saw_variant_price = saw_variant_compare_at_price | times: saw_discount %}
{% endif %}

{% if saw_has_discount == false or saw_variant_price >= saw_variant_compare_at_price %}
  {% assign WCItem_OriginalPrice = item.original_price %}
  {% assign WCItem_FinalPrice = item.final_price %}
  {% assign WCItem_Price = item.price %}
  {% assign WCItem_PriceMin = item.price_min %}
  {% assign WCItem_PriceMax = item.price_max %}
  {% assign WCItem_CompareAtPrice = item.compare_at_price %}
  {% assign WCItem_CompareAtPriceMin = item.compare_at_price_min %}
  {% assign WCItem_CompareAtPriceMax = item.compare_at_price_max %}
  {% assign WCItem_OriginalLinePrice = item.original_line_price %}
  {% assign WCItem_FinalLinePrice = item.final_line_price %}
  {% assign WCItem_LinePrice = item.line_price %}
{% else %}
  {% assign WCItem_OriginalPrice = saw_variant_compare_at_price %}
  {% assign WCItem_FinalPrice = saw_variant_price %}
  {% assign WCItem_Price = saw_variant_price %}
  {% assign WCItem_PriceMin = item.price_min | times: saw_discount %}
  {% assign WCItem_PriceMax = item.price_max | times: saw_discount %}
  {% assign WCItem_CompareAtPrice = saw_variant_compare_at_price %}
  {% if base_product.compare_at_price_min != 0 %}{% assign WCItem_CompareAtPriceMin = base_product.compare_at_price_min %}{% else %}{% assign WCItem_CompareAtPriceMin = base_product.price_min %}{% endif %}
  {% if base_product.compare_at_price_max != 0 %}{% assign WCItem_CompareAtPriceMax = base_product.compare_at_price_max %}{% else %}{% assign WCItem_CompareAtPriceMax = base_product.price_max %}{% endif %}
  {% assign WCItem_OriginalLinePrice = WCItem_OriginalPrice | round | times: item.quantity %}
  {% assign WCItem_FinalLinePrice = WCItem_FinalPrice | round | times: item.quantity %}
  {% assign WCItem_LinePrice = WCItem_Price | round | times: item.quantity %}
{% endif %}
{% comment %} Wholesale_Club_Item_Prices End {% endcomment %}

            {% if item.product.title == "#TeamBioSteel Hydration Kit" %}
                     <style>
                        .order-summary__section--discount{
                      display:none;
                          }
                      </style>
              {% endif %}
    {% endfor %}
    
    <script type="text/javascript">
      
      //free Team Bottle
      
      {% comment %}
      
      {% assign free_gift_variant_id = 15724230574198 %}
      var free_gift_variant_id = {{free_gift_variant_id}};
      {% assign free_gift_exists = false %}
      {% assign free_gift_qty = null %}
      
      var lineItems = [];
      {% for item in checkout.line_items %}
{%- comment -%} Wholesale_Club_Product_Visibility_For_Loop Start {%- endcomment -%}
{%- capture hide_resource -%}{% render "wc_product_visibility", resource: item %}{%- endcapture -%}
{%- if hide_resource == "true" -%}
  {% continue %}
{%- endif -%}
{%- comment -%} Wholesale_Club_Product_Visibility_For_Loop End {%- endcomment -%}

{% comment %} Wholesale_Club_Item_Prices Start {% endcomment %}
{% if item.product %}{% assign base_product = item.product %}{% else %}{% assign base_product = item %}{% endif %}
{% if item.variant %}{% assign base_variant = item.variant %}{% else %}{% assign base_variant = item.selected_or_first_available_variant %}{% endif %}

{% if shop.metafields.sawholesale['base_price'] == blank %}
  {% assign base_price = 'compare_at_price' %}
{% else %}
  {% assign base_price = shop.metafields.sawholesale['base_price'] %}
{% endif %}

{% assign saw_discount = 0 %}{% assign saw_has_discount = false %}

{% if customer.tags != blank %}
  {% for mf in base_product.metafields.sawholesale %}
{%- comment -%} Wholesale_Club_Product_Visibility_For_Loop Start {%- endcomment -%}
{%- capture hide_resource -%}{% render "wc_product_visibility", resource: mf %}{%- endcapture -%}
{%- if hide_resource == "true" -%}
  {% continue %}
{%- endif -%}
{%- comment -%} Wholesale_Club_Product_Visibility_For_Loop End {%- endcomment -%}

    {% capture product_customer_tag %}{{ mf | first | replace: 'discount_', '' }}{% endcapture %}
    {% if customer.tags contains product_customer_tag %}
      {% assign saw_has_discount = true %}
      {% assign discount_key = product_customer_tag | prepend: 'discount_' %}
      {% assign price_key = product_customer_tag | prepend: 'price_' %}
      {% assign saw_discount = base_product.metafields.sawholesale[discount_key] | divided_by: 100.0 %}
    {% endif %}
  {% endfor %}
{% endif %}

{% assign saw_discount = 1 | minus: saw_discount %}

{% if base_price == 'price' or base_variant.compare_at_price == blank  or base_variant.compare_at_price == 0 or base_variant.compare_at_price < base_variant.price %}
  {% assign saw_variant_compare_at_price = base_variant.price %}
{% else %}
  {% assign saw_variant_compare_at_price = base_variant.compare_at_price %}
{% endif %}

{% assign cpe = shop.metafields.sawholesale['cpe'] | default: "true" %}
{% if base_variant.metafields.sawholesale[price_key] != blank and cpe == "true" %}
  {% assign saw_variant_price = base_variant.metafields.sawholesale[price_key] %}
{% else %}
  {% assign saw_variant_price = saw_variant_compare_at_price | times: saw_discount %}
{% endif %}

{% if saw_has_discount == false or saw_variant_price >= saw_variant_compare_at_price %}
  {% assign WCItem_OriginalPrice = item.original_price %}
  {% assign WCItem_FinalPrice = item.final_price %}
  {% assign WCItem_Price = item.price %}
  {% assign WCItem_PriceMin = item.price_min %}
  {% assign WCItem_PriceMax = item.price_max %}
  {% assign WCItem_CompareAtPrice = item.compare_at_price %}
  {% assign WCItem_CompareAtPriceMin = item.compare_at_price_min %}
  {% assign WCItem_CompareAtPriceMax = item.compare_at_price_max %}
  {% assign WCItem_OriginalLinePrice = item.original_line_price %}
  {% assign WCItem_FinalLinePrice = item.final_line_price %}
  {% assign WCItem_LinePrice = item.line_price %}
{% else %}
  {% assign WCItem_OriginalPrice = saw_variant_compare_at_price %}
  {% assign WCItem_FinalPrice = saw_variant_price %}
  {% assign WCItem_Price = saw_variant_price %}
  {% assign WCItem_PriceMin = item.price_min | times: saw_discount %}
  {% assign WCItem_PriceMax = item.price_max | times: saw_discount %}
  {% assign WCItem_CompareAtPrice = saw_variant_compare_at_price %}
  {% if base_product.compare_at_price_min != 0 %}{% assign WCItem_CompareAtPriceMin = base_product.compare_at_price_min %}{% else %}{% assign WCItem_CompareAtPriceMin = base_product.price_min %}{% endif %}
  {% if base_product.compare_at_price_max != 0 %}{% assign WCItem_CompareAtPriceMax = base_product.compare_at_price_max %}{% else %}{% assign WCItem_CompareAtPriceMax = base_product.price_max %}{% endif %}
  {% assign WCItem_OriginalLinePrice = WCItem_OriginalPrice | round | times: item.quantity %}
  {% assign WCItem_FinalLinePrice = WCItem_FinalPrice | round | times: item.quantity %}
  {% assign WCItem_LinePrice = WCItem_Price | round | times: item.quantity %}
{% endif %}
{% comment %} Wholesale_Club_Item_Prices End {% endcomment %}

        {% if item.variant_id == free_gift_variant_id %}
          {% assign free_gift_exists = true %}
          {% assign free_gift_qty = item.quantity %}
        {% else %}
        lineItems.push("{{item.variant_id}}:{{ item.quantity }}");
        {% endif %}
      {% endfor %}
      {% assign update_cart = false %}
                       
      {% if promo_coupon_applied == true %}
        {% if free_gift_exists == false or free_gift_qty > 1 %}
          lineItems.push(free_gift_variant_id+":1");
          {% assign update_cart = true %}
        {% endif %}
      {% elsif free_gift_exists == true %}
        {% assign update_cart = false %}
      {% endif %}
                       
      {% if update_cart == true %}
        var line_items = lineItems.join(",");
        window.location = "https://biosteel.ca/cart/"+line_items;
      {% endif %}
      
      // free Team Bottle
      {% endcomment %}
      
      $(".field__input-btn-wrapper .field__input-btn").click(function(){
        setTimeout(function(){
          saveFieldValues();
          
          location.reload();
        },6000);
      });
      
      $(".tag__button").click(function(){
        setTimeout(function(){
          saveFieldValues();
          
          location.reload();
        },6000);
      });
      
      
      
      var fieldHTML = '<div class="field field-address2-prefix field--required field--third field--show-floating-label">';
        fieldHTML = fieldHTML + '<div class="field__input-wrapper field__input-wrapper--select">';
          fieldHTML = fieldHTML + '<label class="field__label field__label--visible">Type</label>';
          fieldHTML = fieldHTML + '<select id="address2prefix" onchange="updateaddress2prefix()" class="field__input field__input--select">';
            fieldHTML = fieldHTML + '<option value="Apt.">Apartment</label>';
            fieldHTML = fieldHTML + '<option value="Suite">Suite</label>';
            fieldHTML = fieldHTML + '<option value="Suite">Floor</label>';
            fieldHTML = fieldHTML + '<option value="Suite">Room Number</label>';
            fieldHTML = fieldHTML + '<option value="Suite">Door</label>';
            fieldHTML = fieldHTML + '<option value="Suite">PO Box</label>';
            fieldHTML = fieldHTML + '<option value="Suite">ATTN</label>';
            fieldHTML = fieldHTML + '<option value="Suite">C/O</label>';
          fieldHTML = fieldHTML + '</select>';
          fieldHTML = fieldHTML + '<div class="field__caret">';
            fieldHTML = fieldHTML + '<svg class="icon-svg icon-svg--color-adaptive-lighter icon-svg--size-10 field__caret-svg" role="presentation" aria-hidden="true" focusable="false"> <use xlink:href="#caret-down"></use> </svg>';
          fieldHTML = fieldHTML + '</div>';      
        fieldHTML = fieldHTML + '</div>';
      fieldHTML = fieldHTML + '</div>';
      
      function addPrefixField(){
        if($(".field-address2-prefix").length == 0){
          $("[data-address-field=address2]").addClass("field--two-thirds");
          $("[data-address-field=address2]").before(fieldHTML);
          
          setTimeout(function(){
            var address2 = $("#checkout_shipping_address_address2").val();
            if(address2 && address2 != "" && address2 != null){
              var address2arr = address2.split(" ");
              if(address2arr[0] == "Suite"){
                $("#address2prefix").val("Suite");
              }
            }
          },100);
        }
      }
      
      $(document).ready(function(){
        addPrefixField();
        setInterval(addPrefixField,1000);
      });
      
      $('body').on('change','#checkout_shipping_address_country',function(){
        $(".field-address2-prefix").remove();
      });
      
      function updateaddress2prefix(){
        var address2 = $("#checkout_shipping_address_address2").val();
        if(address2.indexOf("Apt.") == 0){
          address2 = address2.slice(5);
        }
        else if(address2.indexOf("Suite") == 0){
          address2 = address2.slice(6);
        }
        var address2prefix = $("#address2prefix").val();
        if(address2 && address2 != "" && address2 != null && address2prefix){
          address2 = address2prefix + " " + address2;
          $("#checkout_shipping_address_address2").val(address2);
        }
      }
      
      $("#checkout_shipping_address_address2").focusout(function(){
        updateaddress2prefix();
      });
      
    </script>

    <script type="text/javascript">
      if(Shopify.Checkout.step == "shipping_method"){
        var msg = "Deliveries may be delayed an extra 5-7 business days due to increased order volumes and supply chain delays. You'll automatically receive a tracking link as soon as your order ships.";
        var shipping_msg = '<div class="section">';
          shipping_msg += '<div class="content-box" style="padding: 10px;color: red;">';
            shipping_msg += msg;
          shipping_msg += '</div>';
        shipping_msg += '</div>';
        $(".section:last").after(shipping_msg);
      }
    </script>

    
    
    
    
    
    
    {% comment %}welcome box script{% endcomment %}
    
    {% assign coupon_applied = false %}
    {% for discount in checkout.discount_applications %}
{%- comment -%} Wholesale_Club_Product_Visibility_For_Loop Start {%- endcomment -%}
{%- capture hide_resource -%}{% render "wc_product_visibility", resource: discount %}{%- endcapture -%}
{%- if hide_resource == "true" -%}
  {% continue %}
{%- endif -%}
{%- comment -%} Wholesale_Club_Product_Visibility_For_Loop End {%- endcomment -%}

      {% assign code_size = discount.title | size %}
      {% assign cletter = discount.title | slice: 0, 2 %}
      {% if cletter == "WB" or cletter == "wb" %}
        {% assign coupon_applied = true %}
        {% break %}
      {% endif %}
    {% endfor %}
    
    {% assign gift_count = 0 %}
    {% assign item_count = 0 %}
    {% for item in checkout.line_items %}
{%- comment -%} Wholesale_Club_Product_Visibility_For_Loop Start {%- endcomment -%}
{%- capture hide_resource -%}{% render "wc_product_visibility", resource: item %}{%- endcapture -%}
{%- if hide_resource == "true" -%}
  {% continue %}
{%- endif -%}
{%- comment -%} Wholesale_Club_Product_Visibility_For_Loop End {%- endcomment -%}

{% comment %} Wholesale_Club_Item_Prices Start {% endcomment %}
{% if item.product %}{% assign base_product = item.product %}{% else %}{% assign base_product = item %}{% endif %}
{% if item.variant %}{% assign base_variant = item.variant %}{% else %}{% assign base_variant = item.selected_or_first_available_variant %}{% endif %}

{% if shop.metafields.sawholesale['base_price'] == blank %}
  {% assign base_price = 'compare_at_price' %}
{% else %}
  {% assign base_price = shop.metafields.sawholesale['base_price'] %}
{% endif %}

{% assign saw_discount = 0 %}{% assign saw_has_discount = false %}

{% if customer.tags != blank %}
  {% for mf in base_product.metafields.sawholesale %}
{%- comment -%} Wholesale_Club_Product_Visibility_For_Loop Start {%- endcomment -%}
{%- capture hide_resource -%}{% render "wc_product_visibility", resource: mf %}{%- endcapture -%}
{%- if hide_resource == "true" -%}
  {% continue %}
{%- endif -%}
{%- comment -%} Wholesale_Club_Product_Visibility_For_Loop End {%- endcomment -%}

    {% capture product_customer_tag %}{{ mf | first | replace: 'discount_', '' }}{% endcapture %}
    {% if customer.tags contains product_customer_tag %}
      {% assign saw_has_discount = true %}
      {% assign discount_key = product_customer_tag | prepend: 'discount_' %}
      {% assign price_key = product_customer_tag | prepend: 'price_' %}
      {% assign saw_discount = base_product.metafields.sawholesale[discount_key] | divided_by: 100.0 %}
    {% endif %}
  {% endfor %}
{% endif %}

{% assign saw_discount = 1 | minus: saw_discount %}

{% if base_price == 'price' or base_variant.compare_at_price == blank  or base_variant.compare_at_price == 0 or base_variant.compare_at_price < base_variant.price %}
  {% assign saw_variant_compare_at_price = base_variant.price %}
{% else %}
  {% assign saw_variant_compare_at_price = base_variant.compare_at_price %}
{% endif %}

{% assign cpe = shop.metafields.sawholesale['cpe'] | default: "true" %}
{% if base_variant.metafields.sawholesale[price_key] != blank and cpe == "true" %}
  {% assign saw_variant_price = base_variant.metafields.sawholesale[price_key] %}
{% else %}
  {% assign saw_variant_price = saw_variant_compare_at_price | times: saw_discount %}
{% endif %}

{% if saw_has_discount == false or saw_variant_price >= saw_variant_compare_at_price %}
  {% assign WCItem_OriginalPrice = item.original_price %}
  {% assign WCItem_FinalPrice = item.final_price %}
  {% assign WCItem_Price = item.price %}
  {% assign WCItem_PriceMin = item.price_min %}
  {% assign WCItem_PriceMax = item.price_max %}
  {% assign WCItem_CompareAtPrice = item.compare_at_price %}
  {% assign WCItem_CompareAtPriceMin = item.compare_at_price_min %}
  {% assign WCItem_CompareAtPriceMax = item.compare_at_price_max %}
  {% assign WCItem_OriginalLinePrice = item.original_line_price %}
  {% assign WCItem_FinalLinePrice = item.final_line_price %}
  {% assign WCItem_LinePrice = item.line_price %}
{% else %}
  {% assign WCItem_OriginalPrice = saw_variant_compare_at_price %}
  {% assign WCItem_FinalPrice = saw_variant_price %}
  {% assign WCItem_Price = saw_variant_price %}
  {% assign WCItem_PriceMin = item.price_min | times: saw_discount %}
  {% assign WCItem_PriceMax = item.price_max | times: saw_discount %}
  {% assign WCItem_CompareAtPrice = saw_variant_compare_at_price %}
  {% if base_product.compare_at_price_min != 0 %}{% assign WCItem_CompareAtPriceMin = base_product.compare_at_price_min %}{% else %}{% assign WCItem_CompareAtPriceMin = base_product.price_min %}{% endif %}
  {% if base_product.compare_at_price_max != 0 %}{% assign WCItem_CompareAtPriceMax = base_product.compare_at_price_max %}{% else %}{% assign WCItem_CompareAtPriceMax = base_product.price_max %}{% endif %}
  {% assign WCItem_OriginalLinePrice = WCItem_OriginalPrice | round | times: item.quantity %}
  {% assign WCItem_FinalLinePrice = WCItem_FinalPrice | round | times: item.quantity %}
  {% assign WCItem_LinePrice = WCItem_Price | round | times: item.quantity %}
{% endif %}
{% comment %} Wholesale_Club_Item_Prices End {% endcomment %}

      {% if item.product.tags contains "welcome_box_gift" %}
        {% assign gift_count = gift_count | plus:1 %}
      {% else %}
        {% assign item_count = item_count | plus:1 %}
      {% endif %}
    {% endfor %}
    
    {% if gift_count > 0 and item_count == 0 %}
    <script type="text/javascript">
      function removeCoupon(){
        setCookie("show_welcom_gift_warning","1");
        
        var message = "Minimum one item must be purchased to receive the free welcome box. Add another product to your cart and apply your coupon to redeem your free gift. <a href='/collections/all-products'>Click Here To Keep Shopping</a>";
        //alert("minimum one item must be purchased along with free gift.");
        $(".tags-list .tag__button").click();
        setTimeout(function(){
          if($("#error-for-reduction_code").length == 0){
            
            $.magnificPopup.open({
              items: {
                src: '#welcome_box_popup',
                type: 'inline'
              }
            });
            
            $('input[data-trekkie-id="reduction_code_field"]').parent().parent().parent().addClass("field--error");
            $('input[data-trekkie-id="reduction_code_field"]').parent().parent().after('<p id="error-for-reduction_code" class="field__message field__message--error">'+message+'</p>');
          }
        },2000);
        setTimeout(function(){
          if($("#error-for-reduction_code").length == 0){
            
            $.magnificPopup.open({
              items: {
                src: '#welcome_box_popup',
                type: 'inline'
              }
            });
            
            $('input[data-trekkie-id="reduction_code_field"]').parent().parent().parent().addClass("field--error");
            $('input[data-trekkie-id="reduction_code_field"]').parent().parent().after('<p id="error-for-reduction_code" class="field__message field__message--error">'+message+'</p>');
          }
        },3000);
      }
      {% if coupon_applied == true %}
      removeCoupon();
      {% endif %}
      
      $("body").on('click',"button[data-trekkie-id='apply_discount_button']",function(){
        var couponCode = $("input[data-trekkie-id='reduction_code_field']").val();
        
        if(couponCode.substring(0,2) == "WB" || couponCode.substring(0,2) == "wb"){
          setTimeout(removeCoupon,2000);
        }
      });      
    </script>
    
    {% if coupon_applied == false %}
    <script type="text/javascript">
      $(document).ready(function(){
        var welwar = getCookie("show_welcom_gift_warning");
        if(welwar == "1"){
          var message = "Minimum one item must be purchased to receive the free welcome box. Add another product to your cart and apply your coupon to redeem your free gift. <a href='/collections/all-products'>Click Here To Keep Shopping</a>";
          if($("#error-for-reduction_code").length == 0){
            
            $.magnificPopup.open({
              items: {
                src: '#welcome_box_popup',
                type: 'inline'
              }
            });
            
            $('input[data-trekkie-id="reduction_code_field"]').parent().parent().parent().addClass("field--error");
            $('input[data-trekkie-id="reduction_code_field"]').parent().parent().after('<p id="error-for-reduction_code" class="field__message field__message--error">'+message+'</p>');
          }
          setTimeout(function(){
            if($("#error-for-reduction_code").length == 0){
              
              $.magnificPopup.open({
                items: {
                  src: '#welcome_box_popup',
                  type: 'inline'
                }
              });
              
              $('input[data-trekkie-id="reduction_code_field"]').parent().parent().parent().addClass("field--error");
              $('input[data-trekkie-id="reduction_code_field"]').parent().parent().after('<p id="error-for-reduction_code" class="field__message field__message--error">'+message+'</p>');
            }
          },2000);
          setTimeout(function(){
            deleteCookie("show_welcom_gift_warning");
            if($("#error-for-reduction_code").length == 0){
              
              $.magnificPopup.open({
                items: {
                  src: '#welcome_box_popup',
                  type: 'inline'
                }
              });
              
              $('input[data-trekkie-id="reduction_code_field"]').parent().parent().parent().addClass("field--error");
              $('input[data-trekkie-id="reduction_code_field"]').parent().parent().after('<p id="error-for-reduction_code" class="field__message field__message--error">'+message+'</p>');
            }
          },3000);
        }
      });
    </script>
    {% endif %}
    
    {% endif %}
    
    {% comment %}
    <script type="text/javascript">
      setInterval(function(){
        if($("[data-product-id=4582647922806]").length > 0){
          $("[data-product-id=4582647922806]").remove();
        }
      },500);
    </script>
    {% endcomment %}
    
    {% assign discount_size = 0 %}
    {% for discount in checkout.discount_applications %}
{%- comment -%} Wholesale_Club_Product_Visibility_For_Loop Start {%- endcomment -%}
{%- capture hide_resource -%}{% render "wc_product_visibility", resource: discount %}{%- endcapture -%}
{%- if hide_resource == "true" -%}
  {% continue %}
{%- endif -%}
{%- comment -%} Wholesale_Club_Product_Visibility_For_Loop End {%- endcomment -%}

    {% if discount.type != "script" %}
      {% assign discount_size = discount_size | plus:1 %}
    {% endif %}
    {% endfor %}
    
    {% assign skipcheck = false %}
    {% assign free_product_found1 = false %}
    {% assign free_product_found2 = false %}
    
    {% for item in checkout.line_items %}
{%- comment -%} Wholesale_Club_Product_Visibility_For_Loop Start {%- endcomment -%}
{%- capture hide_resource -%}{% render "wc_product_visibility", resource: item %}{%- endcapture -%}
{%- if hide_resource == "true" -%}
  {% continue %}
{%- endif -%}
{%- comment -%} Wholesale_Club_Product_Visibility_For_Loop End {%- endcomment -%}

{% comment %} Wholesale_Club_Item_Prices Start {% endcomment %}
{% if item.product %}{% assign base_product = item.product %}{% else %}{% assign base_product = item %}{% endif %}
{% if item.variant %}{% assign base_variant = item.variant %}{% else %}{% assign base_variant = item.selected_or_first_available_variant %}{% endif %}

{% if shop.metafields.sawholesale['base_price'] == blank %}
  {% assign base_price = 'compare_at_price' %}
{% else %}
  {% assign base_price = shop.metafields.sawholesale['base_price'] %}
{% endif %}

{% assign saw_discount = 0 %}{% assign saw_has_discount = false %}

{% if customer.tags != blank %}
  {% for mf in base_product.metafields.sawholesale %}
{%- comment -%} Wholesale_Club_Product_Visibility_For_Loop Start {%- endcomment -%}
{%- capture hide_resource -%}{% render "wc_product_visibility", resource: mf %}{%- endcapture -%}
{%- if hide_resource == "true" -%}
  {% continue %}
{%- endif -%}
{%- comment -%} Wholesale_Club_Product_Visibility_For_Loop End {%- endcomment -%}

    {% capture product_customer_tag %}{{ mf | first | replace: 'discount_', '' }}{% endcapture %}
    {% if customer.tags contains product_customer_tag %}
      {% assign saw_has_discount = true %}
      {% assign discount_key = product_customer_tag | prepend: 'discount_' %}
      {% assign price_key = product_customer_tag | prepend: 'price_' %}
      {% assign saw_discount = base_product.metafields.sawholesale[discount_key] | divided_by: 100.0 %}
    {% endif %}
  {% endfor %}
{% endif %}

{% assign saw_discount = 1 | minus: saw_discount %}

{% if base_price == 'price' or base_variant.compare_at_price == blank  or base_variant.compare_at_price == 0 or base_variant.compare_at_price < base_variant.price %}
  {% assign saw_variant_compare_at_price = base_variant.price %}
{% else %}
  {% assign saw_variant_compare_at_price = base_variant.compare_at_price %}
{% endif %}

{% assign cpe = shop.metafields.sawholesale['cpe'] | default: "true" %}
{% if base_variant.metafields.sawholesale[price_key] != blank and cpe == "true" %}
  {% assign saw_variant_price = base_variant.metafields.sawholesale[price_key] %}
{% else %}
  {% assign saw_variant_price = saw_variant_compare_at_price | times: saw_discount %}
{% endif %}

{% if saw_has_discount == false or saw_variant_price >= saw_variant_compare_at_price %}
  {% assign WCItem_OriginalPrice = item.original_price %}
  {% assign WCItem_FinalPrice = item.final_price %}
  {% assign WCItem_Price = item.price %}
  {% assign WCItem_PriceMin = item.price_min %}
  {% assign WCItem_PriceMax = item.price_max %}
  {% assign WCItem_CompareAtPrice = item.compare_at_price %}
  {% assign WCItem_CompareAtPriceMin = item.compare_at_price_min %}
  {% assign WCItem_CompareAtPriceMax = item.compare_at_price_max %}
  {% assign WCItem_OriginalLinePrice = item.original_line_price %}
  {% assign WCItem_FinalLinePrice = item.final_line_price %}
  {% assign WCItem_LinePrice = item.line_price %}
{% else %}
  {% assign WCItem_OriginalPrice = saw_variant_compare_at_price %}
  {% assign WCItem_FinalPrice = saw_variant_price %}
  {% assign WCItem_Price = saw_variant_price %}
  {% assign WCItem_PriceMin = item.price_min | times: saw_discount %}
  {% assign WCItem_PriceMax = item.price_max | times: saw_discount %}
  {% assign WCItem_CompareAtPrice = saw_variant_compare_at_price %}
  {% if base_product.compare_at_price_min != 0 %}{% assign WCItem_CompareAtPriceMin = base_product.compare_at_price_min %}{% else %}{% assign WCItem_CompareAtPriceMin = base_product.price_min %}{% endif %}
  {% if base_product.compare_at_price_max != 0 %}{% assign WCItem_CompareAtPriceMax = base_product.compare_at_price_max %}{% else %}{% assign WCItem_CompareAtPriceMax = base_product.price_max %}{% endif %}
  {% assign WCItem_OriginalLinePrice = WCItem_OriginalPrice | round | times: item.quantity %}
  {% assign WCItem_FinalLinePrice = WCItem_FinalPrice | round | times: item.quantity %}
  {% assign WCItem_LinePrice = WCItem_Price | round | times: item.quantity %}
{% endif %}
{% comment %} Wholesale_Club_Item_Prices End {% endcomment %}

      {% if item.variant_id == 15724432687222  %}
        {% assign free_product_found1 = true %}
      {% elsif item.variant_id == 31363624730742  %}
        {% assign free_product_found2 = true %}
      {% endif %}
    {% endfor %}
    
    {% if checkout.discount_applications.size > 0 and free_product_found1 == true and total_price > 5000  %}
    {% assign skipcheck = true %}
    {% elsif checkout.discount_applications.size > 0 and free_product_found2  %}
    {% assign skipcheck = true %}
    {% endif %}
    {% if discount_size > 0 and skipcheck == false %}
    <script type="text/javascript">
      $(".order-summary__section--discount .field__input-btn").unbind();
      
      $(".order-summary__section--discount .field__input-btn").click(function(){
        if($('.onediscounterr').length == 0){
          var msg = '<p style="color:red;" class="onediscounterr">Only one discount code per order</p>';
          $("#checkout_reduction_code").parent().parent().after(msg);
          var newcoupon = $("#checkout_reduction_code").val();
          setCookie("newcoupon",newcoupon);
        }
        return false;
      });
    </script>
    {% else %}
    <script type="text/javascript">
      var newcoupon = getCookie("newcoupon");
      if(newcoupon && newcoupon.length > 0){
        $("#checkout_reduction_code").val(newcoupon);
        deleteCookie("newcoupon");
      }
    </script>
    {% endif %}
    
  </body>
</html>